# JustSay - è¯­éŸ³è½¬å½•å·¥å…· PRD

> **ç‰ˆæœ¬**: 1.1  
> **æ—¥æœŸ**: 2025-12-18  
> **çŠ¶æ€**: å·²ç¡®è®¤

---

## 1. äº§å“æ¦‚è¿°

### 1.1 äº§å“åç§°

**JustSay** - æ™ºèƒ½è¯­éŸ³è½¬å½•å·¥å…·

### 1.2 äº§å“å®šä½

ä¸€æ¬¾è½»é‡çº§ã€è·¨å¹³å°çš„è¯­éŸ³è½¬å½•å·¥å…·ï¼Œé€šè¿‡å¿«æ·é”®è§¦å‘å½•éŸ³ï¼Œå®æ—¶å°†è¯­éŸ³è½¬æ¢ä¸ºæ–‡å­—å¹¶è‡ªåŠ¨æ’å…¥åˆ°å½“å‰æ´»åŠ¨çš„è¾“å…¥æ¡†ä¸­ã€‚

### 1.3 ç›®æ ‡ç”¨æˆ·

- éœ€è¦å¤§é‡æ–‡å­—è¾“å…¥çš„åŠå…¬äººå‘˜
- ç¼–ç¨‹å¼€å‘è€…ï¼ˆç¼–å†™æ³¨é‡Šã€æ–‡æ¡£ï¼‰
- å†…å®¹åˆ›ä½œè€…
- æœ‰æ— éšœç¢éœ€æ±‚çš„ç”¨æˆ·
- å¤šè¯­è¨€å·¥ä½œè€…

### 1.4 æ ¸å¿ƒä»·å€¼

- **å¿«é€Ÿè¾“å…¥**ï¼šè¯­éŸ³è¾“å…¥æ¯”æ‰“å­—æ›´å¿«
- **è§£æ”¾åŒæ‰‹**ï¼šå‡å°‘é”®ç›˜ä½¿ç”¨ç–²åŠ³
- **æ— ç¼é›†æˆ**ï¼šåœ¨ä»»ä½•åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨
- **çµæ´»éƒ¨ç½²**ï¼šæ”¯æŒæœ¬åœ°ã€å±€åŸŸç½‘ã€äº‘ç«¯å¤šç§è¯†åˆ«æ–¹æ¡ˆ

---

## 2. åŠŸèƒ½éœ€æ±‚

### 2.1 æ ¸å¿ƒåŠŸèƒ½

#### 2.1.1 å¿«æ·é”®è§¦å‘ (P0)

| éœ€æ±‚é¡¹       | æè¿°                                   |
| ------------ | -------------------------------------- |
| é»˜è®¤å¿«æ·é”®   | å³ä¾§ Alt é”®ï¼ˆRight Altï¼‰               |
| è§¦å‘æ–¹å¼     | **æŒ‰ä½è¯´è¯ï¼Œæ¾å¼€è¯†åˆ«**ï¼ˆPush-to-Talkï¼‰ |
| è‡ªå®šä¹‰å¿«æ·é”® | ç”¨æˆ·å¯åœ¨è®¾ç½®ä¸­ä¿®æ”¹ä¸ºå…¶ä»–æŒ‰é”®æˆ–ç»„åˆé”®   |
| è§†è§‰åé¦ˆ     | å½•éŸ³æ—¶æ˜¾ç¤ºæ‚¬æµ®æŒ‡ç¤ºå™¨ï¼ˆæ³¢å½¢/å›¾æ ‡ï¼‰      |
| éŸ³é¢‘åé¦ˆ     | å¯é€‰ï¼šå¼€å§‹/ç»“æŸå½•éŸ³æ—¶çš„æç¤ºéŸ³          |

#### 2.1.2 è¯­éŸ³å½•åˆ¶ (P0)

| éœ€æ±‚é¡¹   | æè¿°                              |
| -------- | --------------------------------- |
| éŸ³é¢‘æ ¼å¼ | WAV / PCMï¼ˆ16kHz, 16bit, å•å£°é“ï¼‰ |
| æœ€çŸ­å½•åˆ¶ | 0.5 ç§’ï¼ˆè¿‡çŸ­ä¸å¤„ç†ï¼‰              |
| æœ€é•¿å½•åˆ¶ | å¯é…ç½®ï¼Œé»˜è®¤ 60 ç§’                |
| éŸ³é¢‘ç¼“å­˜ | ä¸´æ—¶å­˜å‚¨ï¼Œè¯†åˆ«å®Œæˆååˆ é™¤          |
| é™å™ªå¤„ç† | å¯é€‰ï¼šåŸºç¡€é™å™ªé¢„å¤„ç†              |

#### 2.1.3 è¯­éŸ³è¯†åˆ« (P0)

| éœ€æ±‚é¡¹     | æè¿°                        |
| ---------- | --------------------------- |
| å¤šè¯­è¨€æ”¯æŒ | ä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ç­‰å¸¸è§è¯­è¨€  |
| è‡ªåŠ¨æ£€æµ‹   | å¯é€‰ï¼šè‡ªåŠ¨è¯†åˆ«è¯­è¨€          |
| æ‰‹åŠ¨æŒ‡å®š   | ç”¨æˆ·å¯é”å®šç‰¹å®šè¯­è¨€          |
| æ ‡ç‚¹æ™ºèƒ½   | è‡ªåŠ¨æ·»åŠ æ ‡ç‚¹ç¬¦å·            |
| çƒ­è¯æ”¯æŒ   | å¯é€‰ï¼šè‡ªå®šä¹‰çƒ­è¯/ä¸“ä¸šæœ¯è¯­è¡¨ |

#### 2.1.4 æ–‡æœ¬æ’å…¥ (P0)

| éœ€æ±‚é¡¹     | æè¿°                           |
| ---------- | ------------------------------ |
| æ’å…¥æ–¹å¼   | æ¨¡æ‹Ÿé”®ç›˜è¾“å…¥ï¼ˆå…¼å®¹æ€§æœ€ä½³ï¼‰     |
| ç„¦ç‚¹ä¿æŒ   | å½•éŸ³æœŸé—´ä¿æŒåŸè¾“å…¥æ¡†ç„¦ç‚¹       |
| å‰ªè´´æ¿æ¨¡å¼ | å¯é€‰ï¼šå¤åˆ¶åˆ°å‰ªè´´æ¿è€Œéç›´æ¥è¾“å…¥ |
| è¿½åŠ æ¨¡å¼   | è¿ç»­è¯­éŸ³è¾“å…¥æ—¶è‡ªåŠ¨æ·»åŠ ç©ºæ ¼     |

### 2.2 è¯†åˆ«åç«¯æ”¯æŒ (P0)

> [!IMPORTANT]
> ç³»ç»Ÿéœ€æ”¯æŒä¸‰ç§è¯†åˆ«æ¨¡å¼ï¼Œç”¨æˆ·å¯è‡ªç”±åˆ‡æ¢

#### 2.2.1 æœ¬åœ°æ¨¡å‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æœ¬åœ°æ¨¡å‹æ¶æ„                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä½¿ç”¨æ¨¡å‹ï¼šFaster-Whisper                            â”‚
â”‚                                                     â”‚
â”‚  å†…ç½®æ¨¡å‹ï¼štiny æˆ– baseï¼ˆéšå®‰è£…åŒ…åˆ†å‘ï¼‰                â”‚
â”‚  å¯ä¸‹è½½æ¨¡å‹ï¼šsmall / medium / large-v3              â”‚
â”‚                                                     â”‚
â”‚  ç¡¬ä»¶åŠ é€Ÿï¼š                                          â”‚
â”‚  â€¢ CPU æ¨ç†                                         â”‚
â”‚  â€¢ CUDA (NVIDIA GPU)                               â”‚
â”‚  â€¢ DirectML (Windows)                              â”‚
â”‚  â€¢ Metal (macOS) - åç»­æ”¯æŒ                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| é…ç½®é¡¹   | è¯´æ˜                                                       |
| -------- | ---------------------------------------------------------- |
| å†…ç½®æ¨¡å‹ | tinyï¼ˆçº¦ 75MBï¼Œéšå®‰è£…åŒ…åˆ†å‘ï¼‰                              |
| å¯é€‰æ¨¡å‹ | base(142MB) / small(466MB) / medium(1.5GB) / large-v3(3GB) |
| è®¡ç®—è®¾å¤‡ | CPU / GPU (CUDA)                                           |
| çº¿ç¨‹æ•°   | CPU æ¨ç†æ—¶çš„å¹¶è¡Œçº¿ç¨‹æ•°                                     |
| æ¨¡å‹ç®¡ç† | åº”ç”¨å†…æä¾›æ¨¡å‹ä¸‹è½½ä¸ç®¡ç†åŠŸèƒ½                               |

#### 2.2.2 å±€åŸŸç½‘æ¨¡å‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å±€åŸŸç½‘éƒ¨ç½²æ¶æ„                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚   å®¢æˆ·ç«¯  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  å±€åŸŸç½‘æœåŠ¡å™¨                   â”‚
â”‚   (æœ¬å·¥å…·)    HTTP      (Whisper Server)            â”‚
â”‚              gRPC       (Faster-Whisper-Server)     â”‚
â”‚              WebSocket   (è‡ªå»ºæœåŠ¡)                  â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| é…ç½®é¡¹   | è¯´æ˜                         |
| -------- | ---------------------------- |
| æœåŠ¡åœ°å€ | `http://192.168.x.x:port`    |
| åè®®ç±»å‹ | HTTP REST / gRPC / WebSocket |
| è®¤è¯æ–¹å¼ | æ—  / Token / Basic Auth      |
| è¶…æ—¶è®¾ç½® | è¿æ¥è¶…æ—¶ã€è¯·æ±‚è¶…æ—¶           |

#### 2.2.3 äº‘ç«¯ API

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   äº‘ç«¯ API æ¶æ„                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  æ”¯æŒæœåŠ¡å•†ï¼š                                        â”‚
â”‚  â€¢ OpenAI Whisper API                              â”‚
â”‚  â€¢ Azure Speech Services                           â”‚
â”‚  â€¢ Google Cloud Speech-to-Text                     â”‚
â”‚  â€¢ é˜¿é‡Œäº‘è¯­éŸ³è¯†åˆ«                                    â”‚
â”‚  â€¢ è®¯é£è¯­éŸ³                                         â”‚
â”‚  â€¢ è‡ªå®šä¹‰ OpenAI å…¼å®¹ API                           â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| é…ç½®é¡¹       | è¯´æ˜                   |
| ------------ | ---------------------- |
| API Provider | æœåŠ¡å•†é€‰æ‹©             |
| API Endpoint | API åœ°å€ï¼ˆæ”¯æŒè‡ªå®šä¹‰ï¼‰ |
| API Key      | è®¤è¯å¯†é’¥ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰   |
| æ¨¡å‹é€‰æ‹©     | å¦‚ whisper-1           |
| ä»£ç†è®¾ç½®     | HTTP/HTTPS ä»£ç†        |

### 2.3 ç³»ç»Ÿæ‰˜ç›˜ä¸ UI (P1)

#### 2.3.1 ç³»ç»Ÿæ‰˜ç›˜

- æ˜¾ç¤ºçŠ¶æ€å›¾æ ‡ï¼ˆå¾…æœº/å½•éŸ³ä¸­/å¤„ç†ä¸­ï¼‰
- å³é”®èœå•ï¼šè®¾ç½®ã€æš‚åœã€é€€å‡º
- åŒå‡»æ‰“å¼€è®¾ç½®çª—å£

#### 2.3.2 å½•éŸ³æŒ‡ç¤ºå™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ‚¬æµ®å½•éŸ³æŒ‡ç¤ºå™¨è®¾è®¡               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚   ğŸ¤ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ å½•éŸ³ä¸­...        â”‚
â”‚      ï½ï½ï½ï½ï½ï½ï¼ˆéŸ³é‡æ³¢å½¢ï¼‰             â”‚
â”‚                                         â”‚
â”‚   ä½ç½®ï¼šå¯é…ç½®ï¼ˆè·Ÿéšå…‰æ ‡/å›ºå®šä½ç½®ï¼‰       â”‚
â”‚   é€æ˜åº¦ï¼šå¯è°ƒèŠ‚                         â”‚
â”‚   å¤§å°ï¼šå¯è°ƒèŠ‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.3.3 è®¾ç½®ç•Œé¢

- **å¸¸è§„è®¾ç½®**ï¼šå¼€æœºå¯åŠ¨ã€è¯­è¨€é€‰æ‹©
- **å¿«æ·é”®è®¾ç½®**ï¼šå½•éŸ³å¿«æ·é”®é…ç½®
- **å½•éŸ³è®¾ç½®**ï¼šéŸ³é¢‘è®¾å¤‡é€‰æ‹©ã€éŸ³é‡é˜ˆå€¼
- **è¯†åˆ«è®¾ç½®**ï¼šåç«¯é€‰æ‹©ã€æ¨¡å‹é…ç½®
- **è¾“å‡ºè®¾ç½®**ï¼šæ’å…¥æ–¹å¼ã€æ ¼å¼åŒ–é€‰é¡¹
- **é«˜çº§è®¾ç½®**ï¼šæ—¥å¿—ã€ç¼“å­˜æ¸…ç†

### 2.4 å¢å¼ºåŠŸèƒ½ (P2)

#### 2.4.1 å†å²è®°å½•

- ä¿å­˜æœ€è¿‘ N æ¡è½¬å½•è®°å½•
- æ”¯æŒæœç´¢å’Œå¤åˆ¶
- å¯é€‰ï¼šå¯¼å‡ºå†å²

#### 2.4.2 æ–‡æœ¬åå¤„ç†

- è‡ªåŠ¨é¦–å­—æ¯å¤§å†™
- è‡ªåŠ¨æ·»åŠ æ ‡ç‚¹
- ä¸­è‹±æ–‡æ··åˆä¼˜åŒ–
- è‡ªå®šä¹‰æ›¿æ¢è§„åˆ™

#### 2.4.3 å¤šæ¨¡å‹åˆ‡æ¢

- å¿«æ·é”®åˆ‡æ¢ä¸åŒ profile
- æ ¹æ®åº”ç”¨ç¨‹åºè‡ªåŠ¨åˆ‡æ¢

#### 2.4.4 æµå¼è¯†åˆ«ï¼ˆè¿œæœŸè§„åˆ’ï¼‰

> [!NOTE]
> æµå¼è¯†åˆ«ä¸ºè¿œæœŸåŠŸèƒ½ï¼Œå¯æ”¯æŒå®æ—¶ä¼šè®®è½¬å½•ä¸ç¿»è¯‘åœºæ™¯

- è¾¹è¯´è¾¹æ˜¾ç¤ºè¯†åˆ«ç»“æœ
- å®æ—¶ä¼šè®®è½¬å½•
- å®æ—¶ç¿»è¯‘è¾“å‡º

---

## 3. æŠ€æœ¯æ¶æ„

### 3.1 ç³»ç»Ÿæ¶æ„å›¾

```mermaid
graph TB
    subgraph "ç”¨æˆ·äº¤äº’å±‚"
        HK[å¿«æ·é”®ç›‘å¬] --> AR[éŸ³é¢‘å½•åˆ¶]
        TI[ç³»ç»Ÿæ‰˜ç›˜] --> SET[è®¾ç½®ç•Œé¢]
        FI[æ‚¬æµ®æŒ‡ç¤ºå™¨]
    end

    subgraph "ä¸šåŠ¡é€»è¾‘å±‚"
        AR --> AP[éŸ³é¢‘é¢„å¤„ç†]
        AP --> RC[è¯†åˆ«æ§åˆ¶å™¨]
        RC --> TP[æ–‡æœ¬åå¤„ç†]
        TP --> TI2[æ–‡æœ¬æ’å…¥]
    end

    subgraph "è¯†åˆ«åç«¯å±‚"
        RC --> |æœ¬åœ°| LM[æœ¬åœ°æ¨¡å‹å¼•æ“]
        RC --> |å±€åŸŸç½‘| LN[ç½‘ç»œå®¢æˆ·ç«¯]
        RC --> |äº‘ç«¯| CA[API å®¢æˆ·ç«¯]
    end

    subgraph "æ•°æ®å±‚"
        CFG[(é…ç½®ç®¡ç†)]
        HIS[(å†å²è®°å½•)]
        LOG[(æ—¥å¿—ç³»ç»Ÿ)]
    end

    SET --> CFG
    TP --> HIS
```

### 3.2 æŠ€æœ¯é€‰å‹ï¼ˆå·²ç¡®å®šï¼‰

| å±‚çº§           | æŠ€æœ¯æ–¹æ¡ˆ                           | è¯´æ˜                   |
| -------------- | ---------------------------------- | ---------------------- |
| **è¿è¡Œæ—¶**     | Electron                           | è·¨å¹³å°æ¡Œé¢æ¡†æ¶         |
| **å‰ç«¯**       | React + TypeScript                 | ç°ä»£åŒ– UI å¼€å‘         |
| **æ ·å¼**       | CSS / Tailwind                     | UI æ ·å¼                |
| **æœ¬åœ°æ¨¡å‹**   | Faster-Whisper                     | é€šè¿‡ Python å­è¿›ç¨‹è°ƒç”¨ |
| **éŸ³é¢‘å¤„ç†**   | Web Audio API / node-audiorecorder | å½•éŸ³ä¸é¢„å¤„ç†           |
| **å¿«æ·é”®ç›‘å¬** | electron-globalShortcut / iohook   | å…¨å±€å¿«æ·é”®             |
| **ç½‘ç»œè¯·æ±‚**   | axios / fetch                      | API è°ƒç”¨               |
| **é…ç½®å­˜å‚¨**   | electron-store                     | JSON é…ç½®å­˜å‚¨          |
| **æ‰“åŒ…åˆ†å‘**   | electron-builder                   | å¤šå¹³å°æ‰“åŒ…             |

### 3.3 ç›®å½•ç»“æ„

```
justsay/
â”œâ”€â”€ package.json
â”œâ”€â”€ electron-builder.yml        # æ‰“åŒ…é…ç½®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/                   # Electron ä¸»è¿›ç¨‹
â”‚   â”‚   â”œâ”€â”€ index.ts            # ä¸»è¿›ç¨‹å…¥å£
â”‚   â”‚   â”œâ”€â”€ tray.ts             # ç³»ç»Ÿæ‰˜ç›˜
â”‚   â”‚   â”œâ”€â”€ hotkey.ts           # å¿«æ·é”®ç›‘å¬
â”‚   â”‚   â”œâ”€â”€ audio/
â”‚   â”‚   â”‚   â””â”€â”€ recorder.ts     # éŸ³é¢‘å½•åˆ¶
â”‚   â”‚   â”œâ”€â”€ recognition/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts        # è¯†åˆ«æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ local.ts        # æœ¬åœ° Faster-Whisper
â”‚   â”‚   â”‚   â”œâ”€â”€ network.ts      # å±€åŸŸç½‘æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ api.ts          # äº‘ç«¯ API
â”‚   â”‚   â”œâ”€â”€ input/
â”‚   â”‚   â”‚   â””â”€â”€ simulator.ts    # æ–‡æœ¬è¾“å…¥æ¨¡æ‹Ÿ
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ config.ts       # é…ç½®ç®¡ç†
â”‚   â”‚       â””â”€â”€ logger.ts       # æ—¥å¿—
â”‚   â”œâ”€â”€ renderer/               # Electron æ¸²æŸ“è¿›ç¨‹ (React)
â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Settings.tsx    # è®¾ç½®é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ ModelManager.tsx # æ¨¡å‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â””â”€â”€ Indicator.tsx   # å½•éŸ³æŒ‡ç¤ºå™¨
â”‚   â”‚   â””â”€â”€ styles/
â”‚   â””â”€â”€ preload/                # é¢„åŠ è½½è„šæœ¬
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ python/                     # Python è¯†åˆ«æ¨¡å—
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ whisper_service.py      # Faster-Whisper å°è£…
â”œâ”€â”€ models/                     # æ¨¡å‹ç›®å½•
â”‚   â””â”€â”€ faster-whisper-tiny/    # å†…ç½®å°æ¨¡å‹
â”œâ”€â”€ assets/
â”‚   â””â”€â”€ icons/
â””â”€â”€ README.md
```

---

## 4. è·¨å¹³å°é€‚é…

### 4.1 å¹³å°æ”¯æŒä¼˜å…ˆçº§

| å¹³å°                        | ä¼˜å…ˆçº§ | çŠ¶æ€     |
| --------------------------- | ------ | -------- |
| Windows 10/11               | P0     | é¦–å‘     |
| macOS (Intel/Apple Silicon) | P1     | ç¬¬äºŒé˜¶æ®µ |
| Linux (Ubuntu/Debian)       | P2     | ç¬¬ä¸‰é˜¶æ®µ |

### 4.2 å¹³å°ç‰¹æ®Šå¤„ç†

#### Windows

- å¿«æ·é”®ç›‘å¬ï¼šä½¿ç”¨ `SetWindowsHookEx` æˆ– `RegisterHotKey`
- æ–‡æœ¬æ’å…¥ï¼šä½¿ç”¨ `SendInput` API
- ç³»ç»Ÿæ‰˜ç›˜ï¼šWindows Notification Area API
- éŸ³é¢‘è®¾å¤‡ï¼šWASAPI

#### macOS

- å¿«æ·é”®ç›‘å¬ï¼šéœ€è¦è¾…åŠ©åŠŸèƒ½æƒé™
- æ–‡æœ¬æ’å…¥ï¼šCGEventPost
- ç³»ç»Ÿæ‰˜ç›˜ï¼šNSStatusItem
- éŸ³é¢‘è®¾å¤‡ï¼šCoreAudio
- ç­¾åå…¬è¯ï¼šéœ€è¦ Apple Developer è´¦å·

#### Linux

- å¿«æ·é”®ç›‘å¬ï¼šX11/Wayland å·®å¼‚å¤„ç†
- æ–‡æœ¬æ’å…¥ï¼šxdotool / ydotool
- ç³»ç»Ÿæ‰˜ç›˜ï¼šAppIndicator / StatusNotifierItem
- éŸ³é¢‘è®¾å¤‡ï¼šPulseAudio / PipeWire

---

## 5. é…ç½®æ–‡ä»¶è®¾è®¡

### 5.1 é…ç½®æ–‡ä»¶æ ¼å¼

```toml
# config.toml - VoiceType é…ç½®æ–‡ä»¶

[general]
language = "zh-CN"           # ç•Œé¢è¯­è¨€
autostart = false            # å¼€æœºå¯åŠ¨
minimize_to_tray = true      # æœ€å°åŒ–åˆ°æ‰˜ç›˜

[hotkey]
trigger_key = "RAlt"         # è§¦å‘é”®
modifier_keys = []           # ä¿®é¥°é”® ["Ctrl", "Shift"]
mode = "push_to_talk"        # push_to_talk / toggle

[audio]
device = "default"           # å½•éŸ³è®¾å¤‡
sample_rate = 16000          # é‡‡æ ·ç‡
min_duration_ms = 500        # æœ€çŸ­å½•åˆ¶æ—¶é•¿
max_duration_sec = 60        # æœ€é•¿å½•åˆ¶æ—¶é•¿
noise_reduction = false      # é™å™ªå¼€å…³

[recognition]
backend = "local"            # local / network / api
language = "auto"            # auto / zh / en / ja
punctuation = true           # è‡ªåŠ¨æ ‡ç‚¹
hot_words = []               # çƒ­è¯åˆ—è¡¨

[recognition.local]
model_path = "./models/faster-whisper-tiny"
model_type = "tiny"          # tiny(å†…ç½®)/base/small/medium/large-v3
device = "cpu"               # cpu / cuda
threads = 4
compute_type = "int8"        # float16 / int8 (CPUä¼˜åŒ–)

[recognition.network]
endpoint = "http://192.168.1.100:8080/asr"
protocol = "http"            # http / grpc / websocket
auth_type = "none"           # none / token / basic
auth_token = ""
timeout_sec = 30

[recognition.api]
provider = "openai"          # openai / azure / google / aliyun / custom
endpoint = "https://api.openai.com/v1/audio/transcriptions"
api_key = ""                 # åŠ å¯†å­˜å‚¨
model = "whisper-1"
proxy = ""

[output]
method = "simulate_input"    # simulate_input / clipboard
auto_space = true            # è¿ç»­è¾“å…¥åŠ ç©ºæ ¼
capitalize = true            # é¦–å­—æ¯å¤§å†™
custom_replacements = []     # è‡ªå®šä¹‰æ›¿æ¢è§„åˆ™

[ui]
indicator_enabled = true
indicator_position = "cursor" # cursor / top_right / bottom_right
indicator_opacity = 0.9
sound_feedback = true

[history]
enabled = true
max_records = 100
auto_cleanup_days = 30

[advanced]
log_level = "info"           # debug / info / warn / error
cache_dir = ""               # é»˜è®¤ç³»ç»Ÿä¸´æ—¶ç›®å½•
```

---

## 6. API / æ¥å£è®¾è®¡

### 6.1 è¯†åˆ«åç«¯æ¥å£æŠ½è±¡

```typescript
// è¯­éŸ³è¯†åˆ«åç«¯çš„é€šç”¨æ¥å£
interface SpeechRecognizer {
  // æ‰§è¡Œè¯­éŸ³è¯†åˆ«
  recognize(audio: AudioData): Promise<RecognitionResult>

  // æ£€æŸ¥åç«¯æ˜¯å¦å¯ç”¨
  healthCheck(): Promise<boolean>

  // è·å–æ”¯æŒçš„è¯­è¨€åˆ—è¡¨
  getSupportedLanguages(): Language[]
}

interface AudioData {
  buffer: Buffer // éŸ³é¢‘æ•°æ®
  sampleRate: number // é‡‡æ ·ç‡
  channels: number // é€šé“æ•°
  format: 'wav' | 'pcm' // æ ¼å¼
}

interface RecognitionResult {
  text: string // è¯†åˆ«æ–‡æœ¬
  language?: string // æ£€æµ‹åˆ°çš„è¯­è¨€
  confidence?: number // ç½®ä¿¡åº¦
  durationMs: number // å¤„ç†è€—æ—¶
}
```

### 6.2 ç½‘ç»œ API è¯·æ±‚æ ¼å¼

#### HTTP REST è¯·æ±‚

```json
POST /v1/transcribe
Content-Type: multipart/form-data

{
  "audio": "<base64_encoded_audio>",
  "format": "wav",
  "language": "zh",
  "options": {
    "punctuation": true,
    "hot_words": ["ä¸“æœ‰åè¯"]
  }
}
```

#### HTTP REST å“åº”

```json
{
  "success": true,
  "data": {
    "text": "è¯†åˆ«å‡ºçš„æ–‡æœ¬å†…å®¹",
    "language": "zh",
    "confidence": 0.95,
    "duration_ms": 234
  }
}
```

---

## 7. æ•°æ®æµç¨‹

### 7.1 ä¸»æµç¨‹æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant HK as å¿«æ·é”®ç›‘å¬
    participant AR as éŸ³é¢‘å½•åˆ¶
    participant RC as è¯†åˆ«æ§åˆ¶å™¨
    participant BE as è¯†åˆ«åç«¯
    participant TI as æ–‡æœ¬æ’å…¥

    U->>HK: æŒ‰ä¸‹ Alt é”®
    HK->>AR: å¼€å§‹å½•éŸ³
    AR->>AR: å½•åˆ¶éŸ³é¢‘...
    U->>HK: æ¾å¼€ Alt é”®
    HK->>AR: åœæ­¢å½•éŸ³
    AR->>RC: æäº¤éŸ³é¢‘æ•°æ®
    RC->>BE: è¯·æ±‚è¯†åˆ«
    BE-->>RC: è¿”å›è¯†åˆ«ç»“æœ
    RC->>TI: æ’å…¥æ–‡æœ¬
    TI->>U: æ–‡æœ¬å‡ºç°åœ¨è¾“å…¥æ¡†
```

### 7.2 é”™è¯¯å¤„ç†æµç¨‹

```mermaid
graph TD
    A[å¼€å§‹è¯†åˆ«] --> B{éŸ³é¢‘æœ‰æ•ˆ?}
    B -->|å¦| C[æç¤º: å½•éŸ³æ—¶é•¿ä¸è¶³]
    B -->|æ˜¯| D{åç«¯å¯ç”¨?}
    D -->|å¦| E{æœ‰å¤‡ç”¨åç«¯?}
    E -->|æ˜¯| F[åˆ‡æ¢å¤‡ç”¨åç«¯]
    F --> D
    E -->|å¦| G[æç¤º: è¯†åˆ«æœåŠ¡ä¸å¯ç”¨]
    D -->|æ˜¯| H[å‘é€è¯†åˆ«è¯·æ±‚]
    H --> I{è¯†åˆ«æˆåŠŸ?}
    I -->|æ˜¯| J[æ’å…¥æ–‡æœ¬]
    I -->|å¦| K[æç¤º: è¯†åˆ«å¤±è´¥]
    J --> L[ç»“æŸ]
```

---

## 8. éåŠŸèƒ½éœ€æ±‚

### 8.1 æ€§èƒ½è¦æ±‚

| æŒ‡æ ‡            | ç›®æ ‡å€¼   | è¯´æ˜                 |
| --------------- | -------- | -------------------- |
| å¯åŠ¨æ—¶é—´        | < 2 ç§’   | åº”ç”¨å¯åŠ¨åˆ°å¯ç”¨       |
| å†…å­˜å ç”¨        | < 100 MB | å¾…æœºçŠ¶æ€ï¼ˆä¸å«æ¨¡å‹ï¼‰ |
| å½•éŸ³å»¶è¿Ÿ        | < 50 ms  | æŒ‰é”®åˆ°å¼€å§‹å½•éŸ³       |
| è¯†åˆ«å»¶è¿Ÿ (æœ¬åœ°) | < 2 ç§’   | å¯¹äº 10 ç§’éŸ³é¢‘       |
| æ–‡æœ¬æ’å…¥å»¶è¿Ÿ    | < 100 ms | è¯†åˆ«å®Œæˆåˆ°æ–‡æœ¬æ˜¾ç¤º   |
| CPU å ç”¨ (å¾…æœº) | < 1%     | éå½•éŸ³çŠ¶æ€           |

### 8.2 å®‰å…¨è¦æ±‚

- API å¯†é’¥åŠ å¯†å­˜å‚¨ï¼ˆä½¿ç”¨ç³»ç»Ÿå¯†é’¥é“¾ï¼‰
- éŸ³é¢‘æ•°æ®ä¸æŒä¹…åŒ–å­˜å‚¨
- å¯é€‰ï¼šæœ¬åœ°åªå­˜å‚¨ï¼Œä¸ä¸Šä¼ äº‘ç«¯
- å†å²è®°å½•å¯ä¸€é”®æ¸…é™¤

### 8.3 å¯ç”¨æ€§è¦æ±‚

- å¿«æ·é”®å†²çªæ£€æµ‹ä¸æç¤º
- ç½‘ç»œå¼‚å¸¸æ—¶è‡ªåŠ¨é‡è¯•
- åç«¯ä¸å¯ç”¨æ—¶è‡ªåŠ¨é™çº§
- å®Œå–„çš„é”™è¯¯æç¤ºä¿¡æ¯

---

## 9. é‡Œç¨‹ç¢‘è®¡åˆ’

### Phase 1: MVP (4 å‘¨)

- [x] é¡¹ç›®åˆå§‹åŒ–
- [ ] å¿«æ·é”®ç›‘å¬ (Windows)
- [ ] éŸ³é¢‘å½•åˆ¶ä¸åŸºç¡€å¤„ç†
- [ ] OpenAI Whisper API å¯¹æ¥
- [ ] æ–‡æœ¬æ¨¡æ‹Ÿè¾“å…¥
- [ ] åŸºç¡€ç³»ç»Ÿæ‰˜ç›˜

### Phase 2: æœ¬åœ°æ¨¡å‹ (2 å‘¨)

- [ ] Whisper æœ¬åœ°æ¨¡å‹é›†æˆ
- [ ] GPU åŠ é€Ÿæ”¯æŒ
- [ ] æ¨¡å‹ä¸‹è½½ç®¡ç†

### Phase 3: å®Œå–„ UI (2 å‘¨)

- [ ] è®¾ç½®ç•Œé¢å®Œå–„
- [ ] å½•éŸ³æ‚¬æµ®æŒ‡ç¤ºå™¨
- [ ] å†å²è®°å½•åŠŸèƒ½

### Phase 4: è·¨å¹³å° (3 å‘¨)

- [ ] macOS é€‚é…
- [ ] Linux é€‚é…
- [ ] è·¨å¹³å°æµ‹è¯•

### Phase 5: å¢å¼ºåŠŸèƒ½ (2 å‘¨)

- [ ] å±€åŸŸç½‘æœåŠ¡å™¨å¯¹æ¥
- [ ] å¤š profile æ”¯æŒ
- [ ] çƒ­è¯ä¸åå¤„ç†

---

## 10. å·²ç¡®è®¤å†³ç­–

| é—®é¢˜       | å†³ç­–                                    |
| ---------- | --------------------------------------- |
| æŠ€æœ¯æ ˆ     | âœ… Electron + React + TypeScript        |
| æœ¬åœ°æ¨¡å‹   | âœ… Faster-Whisper                       |
| æµå¼è¯†åˆ«   | âŒ å‰æœŸä¸åšï¼Œè¿œæœŸè§„åˆ’ï¼ˆå¯ç”¨äºä¼šè®®è½¬å½•ï¼‰ |
| æ¨¡å‹åˆ†å‘   | âœ… å†…ç½® tiny æ¨¡å‹ï¼Œå…¶ä»–å¯ä¸‹è½½           |
| è‡ªå®šä¹‰è„šæœ¬ | âŒ ä¸æ”¯æŒ                               |
| å‘½ä»¤æ¨¡å¼   | âŒ ä¸éœ€è¦                               |
| ç»Ÿè®¡åŠŸèƒ½   | âŒ ä¸éœ€è¦                               |

---

## é™„å½• A: ç«å“å‚è€ƒ

| äº§å“             | ä¼˜ç‚¹     | å¯å€Ÿé‰´ç‚¹     |
| ---------------- | -------- | ------------ |
| Windows è¯­éŸ³è¯†åˆ« | ç³»ç»Ÿé›†æˆ | å¿«æ·é”®è®¾è®¡   |
| macOS å¬å†™       | ä½“éªŒæµç•… | UI åé¦ˆ      |
| Whisper.cpp      | æ€§èƒ½ä¼˜ç§€ | æœ¬åœ°æ¨¡å‹ä¼˜åŒ– |
| otter.ai         | åŠŸèƒ½ä¸°å¯Œ | å†å²ç®¡ç†     |

## é™„å½• B: æœ¯è¯­è¡¨

| æœ¯è¯­         | è¯´æ˜                                       |
| ------------ | ------------------------------------------ |
| ASR          | Automatic Speech Recognitionï¼Œè‡ªåŠ¨è¯­éŸ³è¯†åˆ« |
| STT          | Speech-to-Textï¼Œè¯­éŸ³è½¬æ–‡å­—                 |
| Push-to-Talk | æŒ‰ä½è¯´è¯æ¨¡å¼                               |
| Hot Words    | çƒ­è¯ï¼Œä¼˜å…ˆè¯†åˆ«çš„ç‰¹å®šè¯æ±‡                   |
| VAD          | Voice Activity Detectionï¼Œè¯­éŸ³æ´»åŠ¨æ£€æµ‹     |

---

_æ–‡æ¡£æœ€åæ›´æ–°: 2025-12-16_
